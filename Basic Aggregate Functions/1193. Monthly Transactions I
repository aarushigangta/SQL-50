SELECT LEFT(trans_date,7) as month , country, count(*) as trans_count ,
SUM(CASE WHEN state ='approved' THEN 1 ELSE 0 END ) AS  approved_count,
SUM(amount) AS trans_total_amount,
SUM(CASE WHEN state ='approved' THEN AMOUNT ELSE 0 END ) AS approved_total_amount
FROM Transactions
GROUP BY month, country;
